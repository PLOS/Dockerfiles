rhino:
  image: rhino:current
  links:
    - ambradb:ambradb
    - contentrepo:repo
    - solr:solr
  ports:
    - "8080:8080"
  volumes:
    - $HOME/datastores/ingest:/root/datastores/ingest      # is this how you ingest still? look at sfo-dpro-devstack01
    - $HOME/datastores/ingested:/root/datastores/ingested    # make sure these are created on the host first
    - $HOME/datastores/filestore/ambra:/root/datastores/filestore/ambra
  environment:
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_USER=ambra
    - MYSQL_USER_PASSWORD=ambra
    - MYSQL_HOSTNAME=ambradb
    - MYSQL_DATABASE=ambra
    - REPO_SERVICE=http://repo:8080

ambradb:
  image: percona:5.6
  environment:
    - MYSQL_ROOT_PASSWORD=root
  ports:
    - "3306:3306"

solr:
  image: solr:current
  ports:
    - "8983:8080"
  volumes:
    - "$HOME/datastores/solr:/usr/local/tomcat/solr/home/data"
  expose:
    - "8983"

contentrepo:
  image: contentrepo:current
  links:
    - repodb
    - mogilenode
    - mogiletracker
  ports:
    - "8085:8080"
  environment:
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_USER=repouser
    - MYSQL_USER_PASSWORD=
    - MYSQL_HOSTNAME=repodb
    - MYSQL_DATABASE=repo

repodb:
  image: percona:5.6
  environment:
    - MYSQL_ROOT_PASSWORD=root
  ports:
    - "3305:3306"

mogiletracker:
  image: mogiletracker
  links:
    - mogiledb
    - mogilenode
  environment:
    - MOG_DB_HOST=mogiledb
    - MOG_NODE_HOST=mogilenode

mogilenode:
  image: mogilenode

mogiledb:
  image: percona:5.6
  environment:
    - MYSQL_ROOT_PASSWORD=root
