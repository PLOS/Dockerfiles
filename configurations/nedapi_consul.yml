version: '2'

services:

  haproxy:
    extends:
      file: common.yml
      service: haproxy
    ports:
      - "8081:8080"

  consulserver:
    extends:
      file: common.yml
      service: consulserver

  consultemplate:
    extends:
      file: common.yml
      service: consultemplate
    command: -consul=consulserver:8500 -wait=5s -template="/tmp/haproxy.cfg.ctmpl:/usr/local/etc/haproxy/haproxy.cfg:docker restart configurations_haproxy_1" # $$(docker ps -q -f name=haproxy)
    volumes:
      - ${DOCKERFILES}/projects/named-entity.service/haproxy.cfg.ctmpl:/tmp/haproxy.cfg.ctmpl:ro
    volumes_from:
      - haproxy

  nedapi:
    extends:
      file: common.yml
      service: ned-proxyable
    environment:
      - NED_SERVICE=http://nedapi:8081/v1
    # volumes:
    #   - ${DOCKERFILES}/projects/selfsigned.jks:/root/web.jks:ro

  nedcas:
    extends:
      file: common.yml
      service: nedcas

  neddb:
    extends:
      file: common.yml
      service: neddb
