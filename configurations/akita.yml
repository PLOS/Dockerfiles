version: '2'

services:

  akitaproxy:
    extends:
      file: common.yml
      service: akitaproxy
    # ports:
    #   - "80:80"

  akitaconsultemplate:
    extends:
      file: common.yml
      service: akitaconsultemplate
    # command: -consul=consulserver:8500 -wait=5s -template="/tmp/haproxy.cfg.ctmpl:/usr/local/etc/haproxy/haproxy.cfg:docker restart configurations_akitaproxy_1" # $$(docker ps -q -f name=haproxy)
    # volumes:
    #   - ${DOCKERFILES}/projects/akita/haproxy.cfg.ctmpl:/tmp/haproxy.cfg.ctmpl:ro
    volumes_from:
      - akitaproxy

  akita:
    extends:
      file: common.yml
      service: akita-proxyable
    environment:
      - CAS_URL=https://casproxy:443

  casproxy:
    extends:
      file: common.yml
      service: casproxy

  casconsultemplate:
    extends:
      file: common.yml
      service: casconsultemplate
    volumes_from:
      - casproxy

  nedcas:
    extends:
      file: common.yml
      service: nedcas-proxyable

  nedapi:
    extends:
      file: common.yml
      service: nedapi

  consulserver:
    extends:
      file: common.yml
      service: consulserver

  neddb:
    extends:
      file: common.yml
      service: neddb

  mailcatcher:
    extends:
      file: common.yml
      service: mailcatcher
