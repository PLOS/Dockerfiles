akita:
  image: akita:develop
  ports:
    - 80:80
    - 443:443
  links:
    - nedapi:nedapi
    - mailcatcher:mailcatcher
  environment:
    - NED_SERVICE=http://nedapi:8443/v0
    - MAILER_ADDRESS=mailcatcher
    - NED_USERAPP=dev
    - NED_PASSWORD=dev
    - CAS_HOST=localhost   # TODO: split into two variables ?
    - CAS_PORT=8443
    - SECRET_KEY_BASE=secretgoeshere
    - SSL=generatekeys  # options = none, existingkeys, generatekeys
  # volumes:    # when using SSL=existingkeys
  #   - /etc/nginx/ssl/nginx.key:/etc/nginx/ssl/nginx.key:ro
  #   - /etc/nginx/ssl/nginx.crt:/etc/nginx/ssl/nginx.crt:ro

mailcatcher:
  image: mailcatcher
  ports:
    - 1080:1080

nedcas:
  image: nedcas:develop
  links:
    - neddb:neddb
    - nedapi:nedapi
  ports:
    - 8443:8443
  environment:
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_USER=ned
    - MYSQL_USER_PASSWORD=ned
    - MYSQL_HOSTNAME=neddb
    - MYSQL_DATABASE=namedEntities
    - NED_SERVICE=http://nedapi:8443/v0
    - REGISTRATION_BASE_URL=https://localhost   # TODO: fix this

nedapi:
  image: nedapi:develop
  ports:
    - 8081:8080
    - 8444:8443
  links:
    - neddb:neddb
  environment:
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_USER=ned
    - MYSQL_USER_PASSWORD=ned
    - MYSQL_HOSTNAME=neddb
    - MYSQL_DATABASE=namedEntities
    - AMBRA_DATABASE=ambra

neddb:
  image: percona:5.6
  environment:
    - MYSQL_ROOT_PASSWORD=root
  # volumes:    # to persist database between runs
  #   - /var/lib/mysql
